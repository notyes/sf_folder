(function(a){a.fn.jRating=function(q){var r={bigStarsPath:"jquery/icons/stars.png",phpPath:"php/jRating.php",step:!1,isDisabled:!1,canRateAgain:!1,sendRequest:!1,length:5,decimalLength:0,rateMax:5,nbRates:1,onSuccess:null,onError:null,onClick:null};if(0<this.length)return this.each(function(){function s(a){a=parseFloat(100*a/h*parseInt(b.rateMax)/100);var d=Math.pow(10,parseInt(b.decimalLength));return Math.round(a*d)/d}function k(a){return a?a.offsetLeft+k(a.offsetParent):0}var b=a.extend(r,q),g= 0,e=0,c=0,l="",m=!1,n=0,p=b.nbRates,t=a(this).hasClass("jDisabled")||b.isDisabled?!0:!1,e=23,c=20,l=b.bigStarsPath;a(this).height(c);var f=parseFloat(a(this).attr("data-average")),u=parseInt(a(this).attr("data-id")),h=e*b.length;a("<div>",{"class":"jRatingColor",css:{width:f/b.rateMax*h}}).appendTo(a(this));f=a("<div>",{"class":"jRatingAverage",css:{width:0,top:-c}}).appendTo(a(this));a("<div>",{"class":"jStar",css:{width:h,height:c,top:-(2*c),background:"url("+l+") repeat-x"}}).appendTo(a(this)); a(this).css({width:h,overflow:"hidden",zIndex:1,position:"relative"});if(!t)a(this).off().on("mouseover",function(b){a(this).css("cursor","pointer")}).on("mouseout",function(){a(this).css("cursor","default");m?f.width(n):f.width(0)}).on("mousemove",function(a){var d=k(this);a=a.pageX-d;g=b.step?Math.floor(a/e)*e+e:a;f.width(g)}).on("click",function(e){var d=this;m=!0;n=g;p--;(!b.canRateAgain||0>=parseInt(p))&&a(this).unbind().css("cursor","default").addClass("jDisabled");e.preventDefault();var c= s(g);f.width(g);if(b.onClick)b.onClick(d,c);b.sendRequest&&a.post(b.phpPath,{idBox:u,rate:c,action:"rating"},function(a){if(!a.error){if(b.onSuccess)b.onSuccess(d,c)}else if(b.onError)b.onError(d,c)},"json")})})}})(jQuery);